<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>湖中花束 · 正文 · KAKA ARCHIVE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#f6f5f2; --text:#222; --muted:#666; --border:#e3e0da;
      --paper: rgba(255,255,255,.55);
      --headerH: 64px; /* 用于滚动偏移 */
    }

    body{
      margin:0;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"SF Pro Text","PingFang SC","Noto Sans CJK SC",sans-serif;
      background:
        radial-gradient(circle at top left, rgba(255,255,255,0.9) 0, transparent 55%),
        radial-gradient(circle at bottom right, rgba(179,188,255,0.25) 0, transparent 55%),
        var(--bg);
      color:var(--text);
      line-height:1.85;

      opacity:0;
      animation:fadeIn .8s ease-out forwards;
    }
    @keyframes fadeIn { to{opacity:1;} }

    /* 平滑滚动（基础） */
    html{ scroll-behavior:smooth; }

    .site-header{
      position:fixed; top:0; left:0; width:100%;
      z-index:100;
      background:linear-gradient(to bottom, rgba(0,0,0,.5), rgba(0,0,0,0));
      height: var(--headerH);
    }
    .header-inner{
      max-width:1100px; margin:0 auto;
      height: var(--headerH);
      padding:0 1.5rem;
      display:flex; justify-content:space-between; align-items:center;
    }
    .brand-link{
      font-size:.9rem; letter-spacing:.18em; text-transform:uppercase;
      text-decoration:none; color:#fff;
    }

    /* ====== 新：两栏布局 ====== */
    main{
      max-width:1100px;
      margin:0 auto;
      padding: calc(var(--headerH) + 1.4rem) 1.5rem 3.5rem;
    }

    .layout{
      display:grid;
      grid-template-columns: 240px 1fr;
      gap: 2rem;
      align-items:start;
    }

    /* 左侧章节导航 */
    .side{
      position:sticky;
      top: calc(var(--headerH) + 1rem);
      padding: 1rem 0;
      border-right:1px solid rgba(0,0,0,.06);
    }
    .side-title{
      font-size:.78rem;
      letter-spacing:.14em;
      text-transform:uppercase;
      color: rgba(0,0,0,.45);
      margin:0 0 .8rem;
    }
    .side-nav{
      display:flex;
      flex-direction:column;
      gap:.25rem;
    }
    .side-nav a{
      text-decoration:none;
      color:inherit;
      padding:.45rem .6rem;
      border-radius:10px;
      font-size:.9rem;
      line-height:1.35;
    }
    .side-nav a .no{
      display:block;
      font-size:.7rem;
      letter-spacing:.12em;
      text-transform:uppercase;
      color: rgba(0,0,0,.45);
      margin-bottom:.08rem;
    }
    .side-nav a .name{
      display:block;
      font-weight:560;
      letter-spacing:.01em;
    }
    .side-nav a:hover{
      background: rgba(255,255,255,.35);
    }
    .side-nav a.is-active{
      background: rgba(255,255,255,.70);
      outline: 1px solid rgba(0,0,0,.08);
    }

    /* 右侧正文 */
    .content{
      min-width:0;
    }
    .kicker{
      font-size:.75rem; letter-spacing:.18em; text-transform:uppercase;
      color:rgba(0,0,0,.45);
      margin-bottom:.4rem;
    }
    h1{
      font-size:1.6rem; margin:0 0 .6rem;
      letter-spacing:.05em;
    }
    .meta{
      font-size:.85rem; color:rgba(0,0,0,.55);
      margin-bottom:1.2rem;
    }
    .intro{
      max-width:48rem;
      font-size:.95rem; color:var(--muted);
      margin:0 0 2rem;
      text-align:justify; text-align-last:left;
    }

    /* ====== 新：章节排版（正文里留出章节的“版式”） ====== */
    .chapter{
      margin: 2.4rem 0 3rem;
      padding: 1.4rem 1.5rem;
      background: var(--paper);
      border: 1px solid rgba(0,0,0,.06);
      border-radius: 16px;
      backdrop-filter: blur(6px);
    }

    /* 关键：让锚点滚动时避开 fixed header */
    .chapter{
      scroll-margin-top: calc(var(--headerH) + 18px);
    }

    .ch-head{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap: 1rem;
      padding-bottom: .9rem;
      margin-bottom: 1rem;
      border-bottom: 1px solid rgba(0,0,0,.08);
    }
    .ch-left{
      min-width:0;
    }
    .ch-no{
      font-size:.72rem;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:rgba(0,0,0,.45);
      margin-bottom:.2rem;
    }
    .ch-title{
      font-size:1.1rem;
      font-weight:650;
      margin:0;
      letter-spacing:.02em;
    }
    .ch-note{
      font-size:.82rem;
      color:rgba(0,0,0,.55);
      margin-top:.35rem;
    }
    .ch-right{
      font-size:.78rem;
      color:rgba(0,0,0,.45);
      white-space:nowrap;
    }

    .chapter p{
      margin: .9rem 0;
      text-align:justify;
    }

    .back{
      margin-top:2.2rem;
      font-size:.85rem;
    }
    .back a{
      color:inherit;
      text-decoration:none;
      border-bottom:1px solid rgba(0,0,0,.25);
      padding-bottom:2px;
    }

    /* 移动端：目录折叠为顶部横向 */
    @media (max-width:900px){
      .layout{ grid-template-columns: 1fr; }
      .side{
        position:relative;
        top:auto;
        border-right:none;
        border-bottom:1px solid rgba(0,0,0,.06);
        padding: .5rem 0 1rem;
      }
      .side-nav{
        flex-direction:row;
        flex-wrap:wrap;
        gap:.35rem;
      }
      .side-nav a{
        padding:.4rem .55rem;
        border:1px solid rgba(0,0,0,.07);
        background: rgba(255,255,255,.35);
      }
      .side-nav a .no{ display:none; }
      .side-nav a .name{ font-weight:600; }
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <a class="brand-link" href="../../index.html">KAKA ARCHIVE</a>
    </div>
  </header>

  <main>
    <div class="layout">
      <!-- 左侧：章节目录（点击平滑跳转） -->
      <aside class="side" aria-label="章节目录">
        <div class="side-title">Chapters</div>
        <nav class="side-nav" id="sideNav">
          <!-- 这里把原来 href="ch01.html" 改成页内锚点 -->
         <a href="#ch01" data-target="ch00">
            <span class="no">PROLOGUE</span>
            <span class="name">序章</span>
          </a>
          <a href="#ch01" data-target="ch01">
            <span class="no">CHAPTER 01</span>
            <span class="name">第一章 ·（章节标题）</span>
          </a>
          <a href="#ch02" data-target="ch02">
            <span class="no">CHAPTER 02</span>
            <span class="name">第二章 ·（章节标题）</span>
          </a>
          <!-- 继续加... -->
        </nav>
      </aside>

      <!-- 右侧：正文 -->
      <article class="content">
        <div class="kicker">FICTION · SERIES</div>
        <h1>湖边的那些人</h1>
        <div class="meta">连载中 · 当代 · 记忆 · 城市边缘</div>

        <p class="intro">
          这里放简介（像书籍腰封）：这故事关于关系、缺席、以及那些在湖边发生又被城市吞回去的事情。
        </p>


        <section class="chapter" id="ch00" data-chapter>
          <div class="ch-head">
            <div class="ch-left">
              <div class="ch-no">PROLOGUE</div>
              <h2 class="ch-title">序章</h2>
              <div class="ch-note">写作初想</div>
            </div>
            <div class="ch-right">更新：2025.12</div>
          </div>

          <!-- 正文内容：把你的文章段落贴在这里 -->
          <p>向后回看，究竟是如何放下另外一个人我们很难得知。在某一个瞬间你注视着ta的脸庞，耳边的声音告诉自己：他/她的灵魂已然焕然一新了。
            此刻你便对你们的未来不再抱有任何妄想或缠绕的诉求，就像将一团掉在夜晚街上许久的意大利面清洁干净，并且对这条整洁的街道感到满意。
            我想此刻这个人在你心中便不再继续占有令人难捱的空间了，而是悄悄的待在别处，也许是某处一辈子去寻找却再找不到的地方。
            你这样想着，继续在世界上散步，与人擦肩。然后在某一刻，某些时刻，你又无可奈何的回忆。你回想起被涂改的，已离你远去的面孔。
            所有在脑后遗弃的，躲藏在角落的，又不得不重见那令人炫目的光芒。
            在那样的困境里，你站在一个晕头转向的路口，又或许是湖边，无助的像刚学步的婴儿。</p>
        </section>
        
        <!-- 章节 01 -->
        <section class="chapter" id="ch01" data-chapter>
          <div class="ch-head">
            <div class="ch-left">
              <div class="ch-no">CHAPTER 01</div>
              <h2 class="ch-title">第一章 ·（章节标题）</h2>
              <div class="ch-note">一行很轻的提示：比如“雨后 / 初遇 / 便利店灯光”。</div>
            </div>
            <div class="ch-right">更新：2025.12</div>
          </div>

          <!-- 正文内容：把你的文章段落贴在这里 -->
          <p>（第一章正文第一段……）</p>
          <p>（第二段……）</p>
        </section>

        <!-- 章节 02 -->
        <section class="chapter" id="ch02" data-chapter>
          <div class="ch-head">
            <div class="ch-left">
              <div class="ch-no">CHAPTER 02</div>
              <h2 class="ch-title">第二章 ·（章节标题）</h2>
              <div class="ch-note">可选：一句“章节气味”。</div>
            </div>
            <div class="ch-right">草稿</div>
          </div>

          <p>（第二章正文第一段……）</p>
          <p>（第二段……）</p>
        </section>

        <div class="back"><a href="../../fiction.html">← 返回小说列表</a></div>
      </article>
    </div>
  </main>

  <script>
    // 1) 处理 fixed header 的滚动偏移：比纯 scroll-behavior 更稳
    //    （同时保留你想要的“平滑”）
    const headerH = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--headerH')) || 64;

    document.querySelectorAll('.side-nav a[href^="#"]').forEach(a => {
      a.addEventListener('click', (e) => {
        const id = a.getAttribute('href').slice(1);
        const el = document.getElementById(id);
        if(!el) return;

        e.preventDefault();
        const y = el.getBoundingClientRect().top + window.scrollY - (headerH + 14);
        window.scrollTo({ top: y, behavior: 'smooth' });
        history.replaceState(null, '', '#' + id);
      });
    });

    // 2) 自动高亮当前章节（读到哪章，左侧目录哪章亮）
    const nav = document.getElementById('sideNav');
    const links = Array.from(nav.querySelectorAll('a[data-target]'));
    const sections = Array.from(document.querySelectorAll('[data-chapter]'));

    const setActive = (id) => {
      links.forEach(a => a.classList.toggle('is-active', a.dataset.target === id));
    };

    const io = new IntersectionObserver((entries) => {
      // 找到“最接近顶部”的可见章节
      const visible = entries
        .filter(en => en.isIntersecting)
        .sort((a,b) => a.boundingClientRect.top - b.boundingClientRect.top)[0];

      if(visible) setActive(visible.target.id);
    }, {
      root: null,
      threshold: 0.18,
      rootMargin: `-${headerH + 20}px 0px -60% 0px`
    });

    sections.forEach(sec => io.observe(sec));

    // 初始：如果 url 带 hash，先高亮对应章节
    if(location.hash){
      const id = location.hash.slice(1);
      setActive(id);
    } else if(sections[0]) {
      setActive(sections[0].id);
    }
  </script>
</body>
</html>
